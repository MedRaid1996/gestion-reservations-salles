{{!-- 
  Page d'affichage des réservations
  Variables attendues :
  - title : titre de la page
  - reservations : tableau d'objets réservation
  - isEnseignant : booléen indiquant si l'utilisateur est un enseignant
  - classes : tableau des classes (pour les étudiants)
  - selectedClasseId : ID de la classe sélectionnée (pour les étudiants)
--}}

<h2>{{title}}</h2>

{{!-- Bouton de création de réservation (visible uniquement pour les enseignants) --}}
{{#if isEnseignant}}
  <a href="/reservations/new" class="btn" style="margin-bottom: 15px; display: inline-block;">
    ➕ Créer une réservation
  </a>
{{/if}}

{{!-- Sélecteur de classe (visible uniquement pour les étudiants) --}}
{{#unless isEnseignant}}
  <form method="get" action="/reservations/ma-classe" style="margin-bottom: 20px;">
    <label for="classeId">Choisir la classe :</label>

    <select id="classeId" name="classeId">
      {{!-- Liste déroulante des classes disponibles --}}
      {{#each classes}}
        <option value="{{id}}"
          {{#if (eq ../selectedClasseId id)}}selected{{/if}}>
          {{nom}}
        </option>
      {{/each}}
    </select>

    <button type="submit">Afficher les réservations</button>
  </form>
{{/unless}}

<hr>

{{!-- Tableau des réservations --}}
{{#if reservations.length}}
  <table border="1" cellpadding="8" cellspacing="0" style="width: 100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th>Salle</th>
        <th>Classe</th>
        <th>Début</th>
        <th>Fin</th>
        <th>Statut</th>

        {{#if isEnseignant}}
          <th>Actions</th>
        {{/if}}
      </tr>
    </thead>

    <tbody>
      {{!-- Boucle sur chaque réservation pour afficher ses informations --}}
      {{#each reservations}}
        <tr>
          <td>{{salleNom}}</td>
          <td>{{classeNom}}</td>
          <td>{{date_debut}}</td>
          <td>{{date_fin}}</td>
          <td>{{statut}}</td>

          {{!-- Actions disponibles uniquement pour les enseignants --}}
          {{#if ../isEnseignant}}
            <td>
              {{!-- Lien pour annuler la réservation (avec confirmation) --}}
              <a href="/reservations/delete/{{id}}" 
                 onclick="return confirm('Voulez-vous vraiment annuler cette réservation ?');">
                Annuler
              </a>

              &nbsp;|&nbsp;

              {{!-- Lien pour modifier la réservation --}}
              <a href="/reservations/edit/{{id}}">
                Modifier
              </a>
            </td>
          {{/if}}
        </tr>
      {{/each}}
    </tbody>

  </table>

{{else}}
  <p style="margin-top: 20px;">Aucune réservation trouvée pour cette recherche.</p>
{{/if}}

